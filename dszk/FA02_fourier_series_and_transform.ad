= Fourier Series and Transform
:url: ./fa/fourier_series_and_transform/
:page-group: fa
:page-order: FA02

Fourier analysis::
* Study of how general functions (e.g., on stem:[\Reals]) can be approximated by sums of simpler (e.g., trigonometric) functions.
* Fourier's original motivation was to solve the _heat equation_, a partially differentiable equation.
** A partially differentiable equation (PDE) involves multiple variables and one or more of their derivatives.
** Example: I want to know what happens, when I put two rods of different temperatures into contact.

== Fourier series

Fourier series (FS)::
Series expansion (CZ: rozvinutí nekonečné řady) of a periodic function into a sum of basis functions.
+
--
* For basis functions, it uses stem:[\sin] and stem:[\cos] functions with a whole number frequency.
* Foundation for _Fourier analysis_ and expansion of periodic functions in general.
* Simple mathematical tool for approximation of periodic functions.
* The stem:[F(k)] coefficients are called _frequency spectrum_.
* Each stem:[F(k)] coefficient is the projection of the stem:[k]-th basis function onto stem:[f].
* It answers the question: "How important is this basis function in the grand scheme of stem:[f]?"
* Typically, we use a stem:[\log] scale for visualization of the coefficients.
--

Fourier series on stem:[\pi]-periodic functions::
Any stem:[\pi]-period function stem:[f] can be expanded in the following way:
+
[stem]
++++
\begin{aligned}

f(x) &= \sum_{k=0}^\infty (\textcolor{blue}{a_k} \cos(kx) + \textcolor{red}{b_k} \sin(kx)) \\

& \text{where} \\

\textcolor{blue}{a_k} &= \frac{\langle f(x), \cos(kx) \rangle}{\langle \cos(kx), \cos(kx) \rangle} \\

\textcolor{red}{b_k} &= \frac{\langle f(x), \sin(kx) \rangle}{\langle \sin(kx), \sin(kx) \rangle}

\end{aligned}
++++
+
--
* stem:[k] -- frequency at which stem:[\sin] and stem:[\cos] oscillate
* stem:[a_k] -- coefficients of even parts of stem:[f]
* stem:[b_k] -- coefficients of odd parts of stem:[f]
--

Fourier series on L-periodic functions::
Similar to stem:[\pi]-periodic functions, but we multiply stem:[k] by stem:[\frac{2\pi}{L}], where stem:[L \in \reals]:
+
[stem]
++++
\begin{aligned}

\large
f(x) &= \sum_{k=0}^\infty \left( \textcolor{blue}{a_k} \cos\left( \frac{2\pi}{L} kx \right) + \textcolor{red}{b_k} \sin\left( \frac{2\pi}{L} kx \right) \right) \\

\normalsize
& \text{where} \\

\textcolor{blue}{a_k} &= \frac{\langle f(x), \cos(\frac{2\pi}{L} kx) \rangle}{\langle \cos(\frac{2\pi}{L} kx), \cos(\frac{2\pi}{L} kx) \rangle} \\

\textcolor{red}{b_k} &= \frac{\langle f(x), \sin(\frac{2\pi}{L} kx) \rangle}{\langle \sin(\frac{2\pi}{L} kx), \sin(\frac{2\pi}{L} kx) \rangle}

\end{aligned}
++++

Complex Fourier series on stem:[2\pi]-periodic functions::
With complex numbers the formula becomes:
+
[stem]
++++
\begin{aligned}

f(x) &= \sum_{k=-\infty}^\infty F(k) \cdot e^{ikx} \\

& \text{where} \\

x &\in \langle -\pi, \pi \rangle \\

F(x) &= \frac{\langle f(x), e^{ikx} \rangle}{\langle e^{ikx}, e^{ikx} \rangle}

\end{aligned}
++++
+
When we express stem:[F(k)] out of the above formula, it converts time into frequency:
+
[stem]
++++
F(k) = \frac{1}{2\pi} \int_{-\pi}^{\pi} f(x) \cdot e^{-ikx} dx

~~\text{where}~~

k \in \Z
++++

Complex Fourier series on L-periodic functions::
We multiply stem:[k] by stem:[\frac{2\pi}{L}] and adjust the scaling factor and integral boundaries, where stem:[L \in \reals]:
+
Expansion/Frequency -> Time:
+
[stem]
++++
f(x) = \sum_{k=-\infty}^{\infty} F(k) \cdot e^{-\frac{2\pi}{L} ikx}

~~\text{where}~~

x \in \left\langle -\frac{L}{2}, \frac{L}{2} \right\rangle
++++
+
Time -> Frequency:
+
[stem]
++++
F(x) = \frac{1}{L} \int_{-\frac{L}{2}}^{\frac{L}{2}} f(x) \cdot e^{-\frac{2\pi}{L} ikx} dx

~~\text{where}~~

k \in \Z
++++

Why use complex numbers in the Fourier series and Fourier transform?::
+
--
1. They simplify the formula:
** stem:[\cos(kx) + i \cdot \sin(kx) = e^{ikx}] (Euler's formula)
2. With them, FT is can be solved linearly and expressed using matrix multiplication. Without them, it's an optimization problem that must be solved numerically.
** If we used real numbers and, for example, stem:[\sin(km - \alpha)] as the basis function, we would not be able to use matrix multiplication and would have to find stem:[\alpha] numerically.
3. Complex numbers also symbolize rotation, which makes for a nice intuitive explanation (see below).
--

Proof of orthogonality of the Fourier series::
TODO

Gibbs phenomenon::
Functions with discontinuities are hard to be approximated with Fourier series as stem:[\sin] and stem:[\cos] are both smooth.
+
image::./img/fa02_gibbs.png[]

== Fourier transform

Fourier transform (FT)::
Fourier transform stem:[\cal F] is a function taking a signal (a function stem:[f] of time) and converting it to the _frequency domain_ (function stem:[F] of frequencies).
+
--
* FT is a generalization of FS. It's derived from L-periodic complex FS with stem:[L \to \infty].
* FS handles only periodic signal. FT handles aperiodic signal.
* It's total. Lossless. Doesn't throw away any information. It's invertible. A bijection. A linear mapping.
* It a tool for frequency analysis.
--
+
_Inverse_ transform (frequency -> time):
+
[stem]
++++
f(x) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(\omega) \cdot e^{i\omega x} d\omega

~~\text{where}~~

x \in (-\infty,\infty)
++++
+
_Forward_ transform (time -> frequency):
+
[stem]
++++
F(\omega) = \int_{-\infty}^{\infty} f(x) \cdot e^{-i\omega x}

~~\text{where}~~

\omega \in (-\infty, \infty)
++++
+
Commonly:
+
[stem]
++++
\begin{aligned}

F(\omega) &= \mathcal{F}(f(x)) \\
G(\omega) &= \mathcal{F}(g(x))

\end{aligned}
++++

Coefficients of the Fourier transform::
* Each coefficient stem:[F(\omega)] is associated with a basis function stem:[e^{i\omega x}] oscillating at frequency stem:[\omega].
* stem:[F(\omega) = A_\omega \cdot e^{i\phi_\omega}] is simply a complex number, where:
** amplitude stem:[A_\omega] -- strength of basis function stem:[e^{i\omega x}]
** phase stem:[\phi_\omega] -- controls the phase shift of basis function stem:[e^{i\omega x}]

Spectral density::
Plot of stem:[F(\omega)] for stem:[\omega \in (-\infty, \infty)].
+
image::./img/fa02_spectral_density.png[]

Function pairs in the Fourier transform::
* FT of the rectangle function is sinc.
* FT of a Gaussian is a (different) Gaussian.

Intuitive explanation of the Fourier transform <<yt3b1b-ft>>::
+
--
1. Complex numbers describe rotation, therefore multiplying stem:[f] by a set of complex numbers "winds stem:[f] up" around a circle.
2. Sampling this wound-up version of stem:[f] (whether using an integral or sum) means calculating the center of mass of the wound up version.
3. When the center of mass is far away from the origin, the wound-up stem:[f] "aligns" with itself, meaning there is a strong correlation between stem:[f] and the sinusoid given by the "winding" frequency.
** Except in FT, there is no division by the length of the studied interval, so it's a "scaled center of mass". This has the effect that the more persistent a frequency is, the higher its spike.
--
+
image::./img/fa02_intuitive_ft_1.png[]
image::./img/fa02_intuitive_ft_2.png[]
+
NOTE: The "winding" is clockwise by convention. That's why there's a stem:[-i] in the equation.

Properties of the Fourier transform::
* **Shift** affects only the phase
+
[stem]
++++
\mathcal{F}\lbrack f(x-\textcolor{red}{a}) \rbrack (\omega) = \textcolor{red}{e^{-2 \pi \cdot i \cdot a \omega}} F(\omega)
++++
+
* **Scaling** -- Narrowing in the time domain causes widening in the frequency domain, and vice versa:\
+
[stem]
++++
\mathcal{F}\lbrack f(\textcolor{red}{a}x) \rbrack (\omega) = \textcolor{red}{\frac{1}{|a|}} F\left( \frac{\omega}{\textcolor{red}{a}} \right)
++++
+
* **Derivative** enhances high frequencies:
+
[stem]
++++
\begin{aligned}

\mathcal{F}\left\lbrack \textcolor{red}{\frac{\partial}{\partial x}} f(x) \right\rbrack
  &= \textcolor{red}{i \cdot \omega} \cdot F(\omega)
  
\mathcal{F}\left\lbrack \textcolor{red}{\frac{\partial}{\partial^2 x}} f(x) \right\rbrack
  &= \textcolor{red}{i \cdot \omega^2} \cdot F(\omega)

\end{aligned}
++++

Convolution theorem (CZ: věta o konvoluci)::
Given two signals stem:[f] and stem:[g] and their Fourier transforms stem:[F] and stem:[G], respectively, the following holds:
+
--
* stem:[\mathcal{F}(f * g) = F \cdot G]
* stem:[\mathcal{F}(f \cdot g) = F * G]
--
+
where 'stem:[*]' stands for a _convolution_ and 'stem:[\cdot]' for point-wise multiplication.

Discrete time Fourier Transform (DTFT)::
We sample the time domain:
+
TODO

Discrete Fourier transform (DFT)::
* DTFT with a limited range
* stem:[F(0)] is also called "direct current (DC)", "mean", or "normalizovaný součet"
- prakticky má omezený rozsah, matematicky je periodická a dokonečna se opakuje

Vlastnostni DFT::
- V diskrétním světě nefunguje škálování, máme jen převzorkování.
- Periodicita
  + můžeme sáhnout mimo a bude tam hodnota
  - vstupní signál se tváří periodicky, takže může vzniknout "falešná hrana"
    * řešení - rozmažeme hraje - Hammingovo okno (děláme konvoluci ve frekvenční doméně, takže násobíme v původní doméně)
- zajímají nás nízké frekvence, proto v praxi je ve vizualizacích nula uprostřed
- hermitovská symetrie
- konvoluční teorém - platí, ale potřeba přidat normalizaci
  - kronekrovo delta
  - DFT a IDFT je efektivnější než konvoluce, ale musíme mít signál rozumné délky (na délce třeba 5 se to nevyplatí)
- stretch
  - TODO: proč musím snížit amplitudu o 1/sqrt(p)?
- u piana a hlasů je v té vizualizaci vpravo dole jen amplituda?
- mixážní pulty umožňují omezit/zvýšit konkrétní rozsahy frekvencí
- fast fourier transform
  - rekurzivní, rozděl a panuj
  - využívá vlastnosti DFT (stretch, shift, linearity), vlastně vůbec nepočítá vzoreček DFT
  - ...ale postupů je víc
  - na dně vracím vstup

1D Fourier transform formula summary::
+
image::./img/fa02_fa_summary.png[]

Low-pass filter::
* Linear filter
* Low frequencies pass through

High-pass filter::
* Linear filter
* High frequences pass through

Sampling::
- Abych mohl vzorkovat, musí mít spojitá funkce omezenou nejvyšší frekvenci. (Jinak se frekvenční spektrum ořízne.)
- Vzorkovací frekvence je zespodu omezená tím, že nechceme ztratit informace, a seshora smysluplností - nechceme plýtvat místem a výkonem.
- Vzorkováním vzniká omezený ale periodický frekvenční prostor.
- Nyquist-Shannon theorem
- Prefiltering jako řešení aliasingu
- Resampling
  - Warping
- Post-filtering - supersampling

== Fourier Transform in 2D

Fourier transform in 2D::
Forward continuous:
+
[stem]
++++
\large
F(u, v) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f(x, y) \cdot e^{-i \cdot 2\pi \cdot (ux + vy)} dx~dy
++++
+
Inverse continuous:
+
[stem]
++++
\large
f(x, y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} F(u, v) \cdot e^{i \cdot 2\pi \cdot (ux + vy)} du~dv
++++
+
Forward **discrete** (2D DFT) of image with stem:[N \cdot M] pixels:
+
[stem]
++++
\large
F(u, v) = \sum_{x=0}^{N-1} \sum_{y=0}^{M-1} f(x, y) \cdot e^{-i\left( \frac{2\pi}{N}ux + \frac{2\pi}{M} vy \right)}
++++
+
Inverse **discrete** (2D IDFT) of frequency domain with stem:[N \cdot M] values:
+
[stem]
++++
\large
f(x, y) = \sum_{u=0}^{N-1} \frac{1}{NM} \sum_{v=0}^{M-1} F(u, v) \cdot e^{i\left( \frac{2\pi}{N}ux + \frac{2\pi}{M} vy \right)}
++++

Frequency domain (FD) in 2D DFT::
+
--
* We only care about one period of FD. Thus, the FD "image" has the same size as the original.
* We shift the image by stem:[\left(\frac{N}{2}, \frac{M}{2}\right)] so that zero frequency is in the center (and not in the corner).
* The FD has two components (real/imaginary, or magnitude/phase). Typically, we only display magnitude but phase still exists!
* We show the FD magnitudes on a stem:[\log] scale.
--
+
image::./img/fa02_2d_frequency_domain.png[]
+
Visually, each stem:[\omega = (u, v)] vector of FD represents a 2D sinusoidal function of stem:[(x, y)]. Magnitude of stem:[\omega] is the frequency. Direction of stem:[\omega] is the orientation of the "waves".
+
image::./img/fa02_2d_basis_function_example.png[]

== Questions

====

Explain the meaning of Fourier coefficients.::
They measure the amount of correlation of a single basis function with the expanded function.

Prove that Fourier transform is a linear mapping.::
TODO

Describe the spectral density plot.::
TODO

Which frequencies dominate in the Gaussian plot?::
TODO

Which operation in frequency domain corresponds to convolution in time domain?::
Point-wise multiplication.

Which frequencies are enhanced if we apply a derivative to an input signal?::
TODO

Define a discrete Fourier basis function with frequency k and overall length N.::
TODO

Create a matrix that can perform forward Fourier transform for a signal of length stem:[N = 2].::
TODO

What is the product of the projection of an even function into a sin wave?::
TODO

Why are the wide functions in time domain transformed into their narrow counterparts in frequency domain and vice versa?::
TODO

Compare the complexity of standard DFT and FFT.::
TODO

What happens in Fourier domain if the signal samples are interleaved with zeros?::
TODO

Prove that DFT is a linear mapping.::
TODO

Why does scaling not work in the case of DFT?::
TODO

Explain the reciprocity of time and frequency domain.::
TODO

Show an example of the aliasing effect.::
TODO

Explain the difference between low-pass and high-pass filter.::
TODO

What is a prefilter?::
TODO

Give an example of stem:[\gamma] warping function.::
TODO

Explain the relationship between DFT and DCT.::
TODO

Describe the F-DCT algorithm and compute stem:[\text{F-DCT}\lparen\lbrack 1, 6, 6, 1 \rbrack\rparen].::
TODO

Is there ever any reason to do a convolution in the frequency domain?::
TODO

====


[bibliography]
== References

* [[[pv291,1]]] David Svoboda, link:https://is.muni.cz/predmet/fi/jaro2025/PV291[PV291 -- Introduction to Digital Signal Processing], 2025
* [[[yt3b1b-ft,2]]] 3Blue1Brown, link:https://www.youtube.com/watch?v=spUNpyF58BY[But what is the Fourier Transform? A visual introduction.], 2018
* [[[yt3b1b-fs,3]]] 3Blue1Brown, link:https://www.youtube.com/watch?v=r6sGWTCMz2k[But what is a Fourier series? From heat flow to drawing with circles], 2019
* https://dsprelated.com/
* https://www.youtube.com/playlist?list=PLMrJAkhIeNNT_Xh3Oy0Y4LTj0Oxo8GqsC
* https://cbia.fi.muni.cz/software/ftutor2d.html
* link:https://is.muni.cz/auth/el/fi/jaro2023/PV131[PV131 -- Digitální zpracování obrazu]
** link:https://is.muni.cz/auth/el/fi/jaro2023/PV131/um/lectures/lecture03_2023.pdf[Lecture 03 -- Multi-dimensional Fourier Transform]
* https://www.robots.ox.ac.uk/~az/lectures/ia/lect2.pdf
